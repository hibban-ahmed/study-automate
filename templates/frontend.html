<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Edu Assistant</title>
  <style>
    body, html {
      height: 100vh;
      margin: 0; padding: 0;
      display: flex;
      flex-direction: column;
      font-family: Arial, sans-serif;
    }
    #container {
      display: flex;
      height: 100%;
      gap: 10px;
    }
    .section {
      flex: 1;
      overflow-y: auto;
      border: 1px solid #ccc;
      padding: 10px;
      box-sizing: border-box;
    }
    textarea {
      width: 100%;
      height: 80%;
      resize: none;
    }
    #output {
      white-space: pre-wrap;
    }
    /* small popup bar on left side */
    #api-key-bar {
      position: fixed;
      left: 0; top: 50%;
      transform: translateY(-50%);
      background: #eee;
      border: 1px solid #ccc;
      padding: 5px;
      z-index: 10;
    }
  </style>
</head>
<body>
  <div id="api-key-bar">
    <label for="model-select">Select Model:</label>
    <select id="model-select">
        <option value="gemini">Gemini</option>
        <option value="llama">LLaMA</option>
    </select>
  </div>
  
  <div id="container">
    <div class="section">
      <h3>Study Content (Resources)</h3>
      <textarea id="resources"></textarea>
    </div>
    <div class="section">
      <h3>Prompt</h3>
      <textarea id="prompt"></textarea>
      <button id="submit-btn">Process</button>
    </div>
    <div class="section">
      <h3>Output</h3>
      <div id="output"></div>
    </div>
  </div>

  <script>
    const submitBtn = document.getElementById('submit-btn');
    const outputDiv = document.getElementById('output');
    const resourcesInput = document.getElementById('resources');
    const promptInput = document.getElementById('prompt');
    const modelSelect = document.getElementById('model-select');

    submitBtn.addEventListener('click', async () => {
      const prompt = promptInput.value.trim();
      const resources = resourcesInput.value.trim();
      const model = modelSelect.value;
      const x_api_key = "meowbaksh_abracadabra_13491"; 
      if(!prompt || !resources) {
        alert("Please fill both study content and prompt");
        return;
      }

      outputDiv.textContent = "Processing...";
      submitBtn.disabled = true;
      submitBtn.textContent = "Processing...";

      try {
        const formData = new FormData();
        formData.append('prompt', prompt);
        formData.append('resources', resources);
        formData.append('model', model);
        formData.append('x_api_key', x_api_key);

        const res = await fetch('/ask', {
          method: 'POST',
          body: formData
        });

        const data = await res.json();
        if (res.ok) {
          outputDiv.textContent = data.result;
        } else {
          outputDiv.innerHTML = `<span style="color: red;">Error: ${data.detail}</span>`;
        }
      } catch (err) {
        outputDiv.innerHTML = `<span style="color: red;">Request failed: ${err.message}</span>`;
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = "Process";
      }
    });
  </script>
</body>
</html>
